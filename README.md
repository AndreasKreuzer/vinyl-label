# vinyllabel - create labels from ID3 tags

This program reads meta data from aiff audio files. The audio stream waveform picture will be rendered into a png image. Album, track information and the waveform picture can be freely used in templated html files.

![example](test/demo/example.png)

## Installation

Following dependencies need to be fullfilled.

```python
pip install mutagen
pip install jinja2
pip install pydub
pip install Pillow
```

## Usage

```python
vinyllabel.py [-h] [--template T] [--debug D] PATH
```

## Configuration

Using `conf/config.json` you are free to map ID3 meta tags on to keys. Each key will be present in the jinja2 html template. Use `--debug` argument to print all tags present in a media file.

```json
"keymapping": {
        "album": {
            "name": "TALB",
            "artist": "TPE2",
            "publisher": "TPUB",
            "country": "TXXX:COUNTRY",
            "year": "TDRC"
        },
        "track": {
            "pos": "TRCK",
            "title": "TIT2",
            "artist": "TPE1",
            "key": "TKEY",
            "genre": "TCON",
            "bpm": "TBPM",
            "rpm": "TXXX:TMT/TT",
            "energy": "TXXX:EnergyLevel"
        }
    }
```
Tag content can be modified freely by regular expressions. In this example key and bpm are getting removed from the track title.

```json
    "regex": {
        "track": {
            "title": "^[0-9]+[a-zA-Z]+ - [0-9]+ - (.*)$"
        }
    }
```

## ID3 tags

### Generating or adding tags

ID3 tags are generated by programs like [iTunes][1] or added later by programs like [Mp3tag][2] or [TagScanner][3]. Programs like [Recordbox][4], [Engine PRIME][5] or [Serato][6] are also analysing audio data and thus generating additional meta data.

See [mutagen-specs.readthedocs.io](https://mutagen-specs.readthedocs.io/en/latest/id3/id3v2.2.html) for a reference how ID3 tags are being used. 

[1]: https://www.apple.com/itunes
[2]: http://www.mp3tag.de
[3]: https://www.xdlab.ru/en/
[4]: https://rekordbox.com/de/
[5]: https://www.denondj.com/downloads
[6]: https://serato.com/dj

### Special keys

Following keys are coming from the media file header or are altered by vinyltag.

| Key    | Value        | Description                    |
| ------ | ------------ | ------------------------------ |
| length | track length | Does not need to be mapped. Comes from audio stream. |
| pos    | track number/total | Comes from TRCK tag. Needs to be mapped into pos key to calculate key's below. |
| posnumber | track number | Comes from pos key. |
| postotal | total tracks | Comes from pos key. |
| posvinyl | vinyl pos | Vinyl side letter and track number. |
